# Документация API

## Авторизация

Чтобы делать любые запросы, нужно получить JWT токен.

Для этого есть два эндпоинта, один для игроков, второй для админов.

Полученный токен нужно потом отправлять в заголовке `Authorization` любого запроса, со значением `Bearer <token>` например:

`Authorization: Bearer asdfj234e23relsdfjkl234j2r3lkask2134dfgdfhgjhej23`.

## POST /api/auth/player

Получение JWT токена для игрока.

### Request body

- **pin** `string`. Пин-код игрока. По сути, пароль. Мы не шифруем пароли игроков в базе, потому что они не живут дольше одной игры.

### Response body

- **token** `string`. JWT токен.
- **team** `int`. Номер команды игрока.

## POST /api/auth/admin

Получение JWT токена для админа.

### Request body

- **login** `string`. Логин админа.
- **password** `string`. Пароль админа.

### Response body

- **token** `string`. JWT токен.
- **name** `int`. Имя админа.
- **login** `int`. Логин админа.

## POST /api/log

Логирование результатов действия игрока. 

В случае успеха возвращает статус `200` и пустой ответ.

### Request body

- **day** `int`. Игровой день.
- **approval** `int`. Суммарное одобрение персонажей.
- **period** `int`. Игровой период.

## POST /api/admin/generate_players

Админ создает новую игры и генерирует пароли для указанного количества игроков.

Все сохраненные данные игроков предыдущих игр будут помечены как скрытые. 

В случае успеха возвращает статус `200` и пустой ответ.

### Request body

- **teamsCount** `int`. Количество команд.

## GET /api/admin/stop_game

Админ останавливает активную игру. Никакие данные не удаляются, но команды не смогут залогиниться по сгенерированным паролям, и данные перестают логироваться.

В случае успеха возвращает статус `200` и пустой ответ.

## GET /api/admin/resume_game

Админ продолжает активную игру. Игроки вновь могут логиниться, игровые данные вновь могут логироваться.

В случае успеха возвращает статус `200` и пустой ответ.

## GET /api/admin/game_results

Админ получает данные актуальные результаты активной игры.

### Response body

Возвращает массив команд с информацией по каждой команде:

- **team** `int`. Номер команды.
- **period** `int`. В каком периоде сейчас находится каждая команда.
- **approval** `int`. Рейтинг одобрения проекта персонажами в каждой команде.
- **days** `int`. Сколько игровых дней потратила каждая команда.
- **tries** `int`. Сколько заходов в игру сделала каждая команда.

## GET /api/admin/players

Список команд и пинкодов для захода в интерфейс для админа.

### Response body

Возвращает массив команд с информацией по каждой команде:

- **playerId** `int`. Айди игрока.
- **team** `int`. Номер команды.
- **pin** `string`. Пароль команды в виде пинкода.